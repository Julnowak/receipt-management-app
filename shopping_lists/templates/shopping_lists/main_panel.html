{% extends "shopping_lists/base.html" %}

{% block content %}
    <style>

        body{
            background-image: linear-gradient(to right, #e0322f, #d22438, #c2183f, #b01043, #9e0c46, #8d0c47, #7b0e46, #6a1043, #57113e, #451138, #340f30, #240c26);
            text-align: center
        }

        .basic_white{
            background-color: white;
            border-radius: 10px;
            padding:20px;
            margin: 10px;
        }

        .chosen_one_box{
            background-color: darkgrey;
            padding: 10px;
            margin: 5px 5px 0 5px;
            transition: 0.5s, opacity 1s;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            width: 30px;
            display: inline-block;
        }

        .chosen_one_box:hover{
            filter: brightness(85%);
            transition: 0.5s, opacity 1s;
        }

        .main_expenses_field{
            margin: 0 5px;
            background-color: red;
            padding: 10px;
            border-radius: 10px;

        }

    </style>

    <div style="color: white; margin: 20px; font-size: 20px">

    {% if user.is_authenticated %}
        Witaj, {{ user.username }}!
    {% else %}
        Witaj, Gościu!
    {% endif %}

    </div>

    <div class="basic_white">
        {% if new_messages_number == 0 %}
            Brak nowych wiadomości
            {% else %}
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-envelope-exclamation" viewBox="0 0 16 16">
                   <path d="M2 2a2 2 0 0 0-2 2v8.01A2 2 0 0 0 2 14h5.5a.5.5 0 0 0 0-1H2a1 1 0 0 1-.966-.741l5.64-3.471L8 9.583l7-4.2V8.5a.5.5 0 0 0 1 0V4a2 2 0 0 0-2-2H2Zm3.708 6.208L1 11.105V5.383l4.708 2.825ZM1 4.217V4a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v.217l-7 4.2-7-4.2Z"/>
                   <path d="M12.5 16a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm.5-5v1.5a.5.5 0 0 1-1 0V11a.5.5 0 0 1 1 0Zm0 3a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0Z"/>
                </svg>
            {% if new_messages_number == 1 %}

                Masz <b>{{ new_messages_number }}</b> nową wiadomość.
            {% elif new_messages_number < 5 %}
                Masz <b>{{ new_messages_number }}</b> nowe wiadomości.
            {% else %}
                Masz <b>{{ new_messages_number }}</b> nowych wiadomości.
            {% endif %}
        {% endif %}
    </div>

    <div class="basic_white">
    Statystyki główne
    </div>

    <div class="basic_white">
        <h4>Wydatki</h4>
        <div>
            <div id="year_box" class="chosen_one_box">Roczne</div>
            <div id="month_box" class="chosen_one_box">M</div>
            <div id="week_box" class="chosen_one_box">T</div>
            <div id="day_box" class="chosen_one_box"> D</div>
            <div id="custom_box" class="chosen_one_box">W</div>
        </div>
        <div class="main_expenses_field">
            <h4 id="expenses_title">Content</h4>
        </div>

    </div>

    <div class="basic_white">
        <h3> Pie Chart </h3>
        {% autoescape off %}
            {{ pie_chart }}
        {% endautoescape %}
    </div>

    <script>
        var year_box = document.getElementById("year_box")
        var month_box = document.getElementById("month_box")
        var week_box = document.getElementById("week_box")
        var day_box = document.getElementById("day_box")
        var custom_box = document.getElementById("custom_box")
        var exp_title = document.getElementById("expenses_title")

        var boxes = [
            year_box,
            month_box,
            week_box,
            day_box,
            custom_box,
             ];

        var names = ["Roczne", "Miesięczne", "Tygodniowe", "Dzienne", "Wybrane"];
        var short_names = ["R", "M", "T", "D", "W"];

        year_box.style.transition = "0";
        year_box.style.backgroundColor = "red";
        year_box.style.width = "100px";
        boxes.forEach((item) => {item.addEventListener('click', wrapper)});

          function wrapper(){
              on_click(event.target)
          }

          function on_click(box){
              var counter = 0
              box.style.backgroundColor = "red";
              boxes.forEach((item) => {
                  if (item === box){
                      item.style.backgroundColor = "red";
                      item.style.width = "100px";

                      item.style.opacity = '100%';
                      let temp = names[counter];
                      setTimeout(function() {
                          item.innerHTML = temp
                        }, 250);
                  }
                  else
                  {
                      item.style.backgroundColor = "darkgray";
                      item.style.width = "30px";


                      item.style.opacity = '50%';

                      item.innerHTML = short_names[counter]


                  }
                  counter += 1;
              });
              exp_title.innerHTML = box.innerText + " wydatki"
          }


    </script>

    <form method="post">
    {% csrf_token %}
    <button type="submit" name="run_script">Run script</button>
</form>

{% endblock content %}